# @TEST-EXEC:  printf 'x' | spicy-driver -d %INPUT >output
# @TEST-EXEC:  btest-diff output

module Test;

type X = unit(s: string&) {
    n: uint8 {
        print "X", s;
        *s = "new";
        # *s = new "new"; # should fail, but doesn't
        # s = new b"new"; # fail
       }
};

public type Y = unit {
    on %init {
        # self.s = "new"; #fail
    }
    x: X(self.s);
    on %done { print "Y", self.s; }

    var s: string& = new "old";
};
